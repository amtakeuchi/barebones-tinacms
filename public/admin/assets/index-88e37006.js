import{r as o,j as s,a as y,F as w,A as D,X as H,R as M,l as U,L as _,b as a,s as G,p as S,c as C}from"./index-9156c753.js";function E(e,t){const[i,m]=o.useState(e);return o.useEffect(()=>{const c=setTimeout(()=>{m(e)},t);return()=>{clearTimeout(c)}},[e,t]),i}function L(e,t){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),o.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))}const R=o.forwardRef(L),h=R,p=e=>({message:e.message,position:e.position&&{endColumn:e.position.end.column,startColumn:e.position.start.column,startLineNumber:e.position.start.line,endLineNumber:e.position.end.line}}),k=e=>{if(!e)return"";const t=p(e);return t?`${t.message}${t.position?` at line: ${t.position.startLineNumber}, column: ${t.position.startColumn}`:""}`:null};function z({error:e}){const t=k(e);return s(y,{className:"relative",children:()=>s(w,{children:[s(D,{className:`p-2 shaodw-lg border ${e?"":" opacity-0 hidden "}`,children:[s("span",{className:"sr-only",children:"Errors"},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:83,columnNumber:13},this),s(h,{className:"h-5 w-5 text-red-400","aria-hidden":"true"},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:84,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:78,columnNumber:11},this),s(H,{enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:s(M,{className:"absolute top-8 w-[300px] -right-3 z-10 mt-3 px-4 sm:px-0",children:s("div",{className:"overflow-hidden rounded-lg shadow-lg ring-1 ring-black ring-opacity-5",children:s("div",{className:"rounded-md bg-red-50 p-4 overflow-scroll",children:s("div",{className:"flex",children:[s("div",{className:"flex-shrink-0",children:s(h,{className:"h-5 w-5 text-red-400","aria-hidden":"true"},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:99,columnNumber:23},this)},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:98,columnNumber:21},this),s("div",{className:"ml-3",children:s("h3",{className:"text-sm font-medium text-red-800 whitespace-pre-wrap",children:t},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:105,columnNumber:23},this)},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:104,columnNumber:21},this)]},void 0,!0,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:97,columnNumber:19},this)},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:96,columnNumber:17},this)},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:95,columnNumber:15},this)},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:94,columnNumber:13},this)},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:86,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:77,columnNumber:9},this)},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/error-message.tsx",lineNumber:75,columnNumber:5},this)}const V=()=>("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16));U.config({paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.31.1/min/vs"}});const $=e=>{const t=_(),i=a.useRef(null),[m,c]=a.useState(100),u=a.useMemo(()=>V(),[]),b=e.field,N=a.useMemo(()=>{const n=G(e.input.value,b,r=>r);return typeof e.input.value=="string"?e.input.value:n},[]),[d,g]=a.useState(N),[l,f]=a.useState(null),x=E(d,500);a.useEffect(()=>{const n=S(d,b,r=>r);if(n.children[0]&&n.children[0].type==="invalid_markdown"){const r=n.children[0];f(r)}else f(null);e.input.onChange(n)},[JSON.stringify(x)]),a.useEffect(()=>{if(i.current)if(l){const n=p(l);t.editor.setModelMarkers(i.current.getModel(),u,[{...n.position,message:n.message,severity:8}])}else t.editor.setModelMarkers(i.current.getModel(),u,[])},[JSON.stringify(l),i.current]),a.useEffect(()=>{t&&(t.languages.typescript.typescriptDefaults.setEagerModelSync(!0),t.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!0}))},[t]);function v(n,r){i.current=n,n.onDidContentSizeChange(()=>{c(Math.min(Math.max(100,n.getContentHeight()),1e3)),n.layout()})}return s("div",{className:"relative",children:[s("div",{className:"sticky top-1 w-full flex justify-between mb-2 z-50 max-w-full bg-white",children:[s(F,{onClick:()=>e.setRawMode(!1),children:"View in rich-text editor ðŸ“"},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/index.tsx",lineNumber:164,columnNumber:9},void 0),s(z,{error:l},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/index.tsx",lineNumber:167,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/index.tsx",lineNumber:163,columnNumber:7},void 0),s("div",{style:{height:`${m}px`},children:s(C,{path:u,onMount:v,options:{scrollBeyondLastLine:!1,tabSize:2,disableLayerHinting:!0,accessibilitySupport:"off",codeLens:!1,wordWrap:"on",minimap:{enabled:!1},fontSize:14,lineHeight:2,formatOnPaste:!0,lineNumbers:"on",lineNumbersMinChars:2,formatOnType:!0,fixedOverflowWidgets:!0,folding:!1,renderLineHighlight:"none",scrollbar:{verticalScrollbarSize:4,horizontalScrollbarSize:4,alwaysConsumeMouseWheel:!1}},language:"markdown",value:d,onChange:n=>{try{g(n)}catch(r){console.log("error",r)}}},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/index.tsx",lineNumber:170,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/index.tsx",lineNumber:169,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/index.tsx",lineNumber:162,columnNumber:5},void 0)},F=e=>s("button",{className:`${e.align==="left"?"rounded-l-md border-r-0":"rounded-r-md border-l-0"} flex justify-center w-full shadow rounded-md bg-white cursor-pointer relative inline-flex items-center px-2 py-2 border border-gray-200 hover:text-white text-sm font-medium transition-all ease-out duration-150 hover:bg-blue-500 focus:z-10 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500`,type:"button",onClick:e.onClick,children:s("span",{className:"text-sm font-semibold tracking-wide align-baseline mr-1",children:e.children},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/index.tsx",lineNumber:229,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/adamt/Documents/GitHub/barebones-tinacms/node_modules/@tinacms/app/src/fields/rich-text/monaco/index.tsx",lineNumber:220,columnNumber:5},void 0),j=$;export{j as default};
